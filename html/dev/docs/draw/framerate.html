<h1>Using frameRate</h1>
<div id="row" class="row">
	<textarea id="code" autofocus="">
/**
 * frameRate is the number of times the draw loop is called in one second and can be set to change this number.
*/

//The default frame rate is 30, but you can set it to any positive integer you'd like. 
//If you set frameRate to 1e-10, then you have practically stopped the draw loop, but if you set the frameRate to 1e-1000, 0, or something negative, the draw loop will go as fast as it can so be careful!

//Play around with frameRate here to see the effects of it!
frameRate = 20;
draw = function() {
	bg(0);
	fill(rand(0, 10), rand(200, 255), rand(100, 200));
	rect(10, 10, 50, 50);
	fill(0);
	rect(mouseX-10, mouseY-10, 20, 20);
};

//WARNING: If you are going to be doing a lot in your draw loop, use frameRate and slow down the draw loop by setting it to a lower value. Calling a function that does a lot at a very fast speed can cause a lot of lag!

/**See also:
  Using the draw loop: http://devdoodle.net/dev/102/
  rand([x[, y]]): http://devdoodle.net/dev/111/
  Using mouseX and mouseY: http://devdoodle.net/dev/114/
*/
	</textarea>
	<iframe id="output" sandbox="allow-scripts"></iframe>
</div>
<style>
	#code {
		color: #fff;
		background: #000;
		font-family: monospace;
		font-size: 1rem;
		resize: none;
		margin-bottom: 8px;
	}
	#code, #output { height: 500px }
	#output { float: right }
	#code { width: 55% }
	#output { width: 44% }
</style>
<script>
	var footerOff = true,
		noPageOverflow = 400,
		pageOverflowMobile = true,
		code = document.getElementById('code');
	code.addEventListener('keypress', function(e) {
		var oldSelectionStart = this.selectionStart;
		if (e.keyCode === 13) {
			if (this.value[oldSelectionStart - 1] == ',') this.eIndent = true;
			var tabs = this.value.substr(0, oldSelectionStart)
				.split('\n')[this.value.substr(0, oldSelectionStart).split('\n').length - 1]
				.split('\t').length
				- (
					('{([:,'.indexOf(this.value[oldSelectionStart - 1]) + 1)
					? 0
					: (
						this.value[oldSelectionStart - 1] == ';' &amp;&amp; this.eIndent
						? (this.eIndent = false || 2) 
						: 1
					)
				);
			this.value = this.value.substr(0, this.selectionStart) + '\n' + '\t'.repeat(tabs) + this.value.substr(this.selectionStart);
			this.selectionStart = ++oldSelectionStart + tabs;
			this.selectionEnd = this.selectionStart;
			e.preventDefault();
		} else if (e.keyCode == 34) {
			this.value = this.value.substr(0, this.selectionStart) + '""' + this.value.substr(this.selectionStart);
			this.selectionEnd = ++oldSelectionStart;
			e.preventDefault();
		} else if (e.keyCode == 39) {
			this.value = this.value.substr(0, this.selectionStart) + "''" + this.value.substr(this.selectionStart);
			this.selectionEnd = ++oldSelectionStart;
			e.preventDefault();
		} else if (e.keyCode == 40) {
			this.value = this.value.substr(0, this.selectionStart) + '()' + this.value.substr(this.selectionStart);
			this.selectionEnd = ++oldSelectionStart;
			e.preventDefault();
		} else if (e.keyCode == 91) {
			this.value = this.value.substr(0, this.selectionStart) + '[]' + this.value.substr(this.selectionStart);
			this.selectionEnd = ++oldSelectionStart;
			e.preventDefault();
		} else if (e.keyCode == 123) {
			this.value = this.value.substr(0, this.selectionStart) + '{}' + this.value.substr(this.selectionStart);
			this.selectionEnd = ++oldSelectionStart;
			e.preventDefault();
		}
		// console.log(e.keyCode);
		run();
	});
	code.addEventListener('keydown', function(e) {
		if (e.keyCode == 8 &amp;&amp; this.selectionStart == this.selectionEnd) {
			console.log(this.value[this.selectionStart - 1] == '(')
			if (
				(this.value[this.selectionStart - 1] == '"' &amp;&amp; this.value[this.selectionStart] == '"') ||
				(this.value[this.selectionStart - 1] == "'" &amp;&amp; this.value[this.selectionStart] == "'") ||
				(this.value[this.selectionStart - 1] == '(' &amp;&amp; this.value[this.selectionStart] == ')') ||
				(this.value[this.selectionStart - 1] == '[' &amp;&amp; this.value[this.selectionStart] == ']') ||
				(this.value[this.selectionStart - 1] == '{' &amp;&amp; this.value[this.selectionStart] == '}')
			) {
				var oldSelectionStart = this.selectionStart;
				this.value = this.value.substr(0, this.selectionStart - 1) + this.value.substr(this.selectionStart + 1);
				this.selectionEnd = --oldSelectionStart;
				e.preventDefault();
			}
		}
	});
	function createCode() {
		return '&lt;!DOCTYPE html>&lt;html>&lt;head>&lt;title>Output frame&lt;/title>&lt;/head>&lt;style>*{margin:0;max-width:100%;box-sizing:border-box}body{background:#000;color:#fff}#canvas{border:1px solid #fff;-webkit-user-select:none;-moz-user-select:none;cursor:default}#console{height:100px;background:#111;overflow:auto;margin-top:8px}#console:empty{display:none}button{display:block}&lt;/style>&lt;body>&lt;canvas id="canvas">&lt;/canvas>&lt;div id="console">&lt;/div>&lt;button onclick="location.reload()">Restart&lt;/button>&lt;script src="/dev/canvas.js">&lt;/script>&lt;script>\'use strict\';try{this.eval(' + JSON.stringify(code.value) + ')}catch(e){error(e)}&lt;/script>&lt;/body>&lt;/html>';
	}
	function run() {
		document.getElementById('output').srcdoc = createCode();
	}
	var oldValue = code.innerHTML;
	function handleCode() {
		if (code.value != oldValue) {
			oldValue = code.value;
			if (!save.classList.contains('progress')) save.textContent = 'Save';
			run();
		}
	}
	var timeout = setTimeout(handleCode, 1000);
	code.addEventListener('keyup', function() {
		clearTimeout(timeout);
		timeout = setTimeout(handleCode, 1000);
	});
	code.addEventListener('keydown', function() {
		clearTimeout(timeout);
		timeout = setTimeout(handleCode, 1000);
	});
	code.addEventListener('keypress', function() {
		clearTimeout(timeout);
		timeout = setTimeout(handleCode, 1000);
		onbeforeunload = function() {
			return 'You have unsaved code.';
		};
	});
	run();
</script>